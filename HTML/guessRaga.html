<html>
    <head>
        <title>
            Guess The Raga
        </title>
        <link type="text/css" rel="stylesheet" href="Untitled-1.css"/>
        
    </head>
    <body>
        <h1>
            Guess The Raga
        </h1>
        <p>
            How to use: <br>
            1. Type a phrase. For example: nSgMPnDPgMgRS<br>
            2. Click Guess to see what the computer thinks!
        </p>
        <input type="text" id="phrase" name="phrase" placeholder="Phrase"/>
        <input type="submit" id="guess" value="Guess" onclick="process()"> 
        <p id="out"></p>
        <script>
            function process(){
                var guesses = [];
                var high = 0;
                var SAPTAKS = {}
                var RAGA_INDEX = ['Bhimpalasi: nSgMPnS SnDPMgRS RnSMPgM',
                              'Pooriya Kalyan: NrGmDNS SNDPmGrS', 
                              'Des: NSRMPNS SnDPMGRGNS'];
                var length = RAGA_INDEX.length;
                for(var i = 0; i < length; i++){
                    SAPTAKS[RAGA_INDEX[i]] = 0;
                }
                phrase = document.getElementById("phrase").value.split('');
                while('-' in phrase){
                    delete phrase[phrase.indexOf('-')];
                }
                console.log(Object.keys(SAPTAKS).length)
                for(var x = 2; x < phrase.length; x++){
                    for(var i = 0; i < phrase.length - x; i++){
                        for(var saptak = 0; saptak < Object.keys(SAPTAKS).length; saptak++){
                            if(Object.keys(SAPTAKS)[saptak].includes(phrase.slice(i, i + x).join(''))){
                                SAPTAKS[Object.keys(SAPTAKS)[saptak]] += 1;
                            }
                        }
                    }
                }
                
                for(var f = 0; f < Object.values(SAPTAKS).length; f++){
                    console.log(f)
                    freq = Object.values(SAPTAKS)[f]
                    if (freq > high){
                        high = freq;
                    }
                }
                
                var keys = Object.keys(SAPTAKS);
                for(var i = 0; i < keys.length; i++){
                    if(SAPTAKS[Object.keys(SAPTAKS)[i]] >= high){
                        guesses.push(Object.keys(SAPTAKS)[i].slice(0, Object.keys(SAPTAKS)[i].indexOf(':')))
                    }
                }
                
                guesses = guesses.join(' or ')
                if(high > 5){
                    document.getElementById("out").innerHTML =  "The result is " + guesses; 
                }
                else{
                    document.getElementById("out").innerHTML =  "I'm not sure."; 
                    
                }
            }
        </script>
    </body>
</html>